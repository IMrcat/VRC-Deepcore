using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using MelonLoader;
using UnityEngine;
using VRC.SDKBase;

namespace DeepCore.Client.Module.Exploits
{
	// Token: 0x02000062 RID: 98
	internal class PickupDropper
	{
		// Token: 0x06000202 RID: 514 RVA: 0x0000D948 File Offset: 0x0000BB48
		public static void State(bool s)
		{
			if (s)
			{
				PickupDropper.cachedPickups.Clear();
				PickupDropper.cachedPickups.AddRange(OnLoadedScaneManager.allBaseUdonItem);
				MelonCoroutines.Start(PickupDropper.Dropper());
				PickupDropper.C = s;
				return;
			}
			MelonCoroutines.Stop(PickupDropper.Dropper());
			PickupDropper.C = s;
			PickupDropper.cachedPickups.Clear();
		}

		// Token: 0x06000203 RID: 515 RVA: 0x0000D99D File Offset: 0x0000BB9D
		public static IEnumerator Dropper()
		{
			while (PickupDropper.C)
			{
				PickupDropper.Drop();
				yield return new WaitForSecondsRealtime(PickupDropper.dropDelay);
			}
			yield break;
			yield break;
		}

		// Token: 0x06000204 RID: 516 RVA: 0x0000D9A8 File Offset: 0x0000BBA8
		public static void Drop()
		{
			VRCPlayerApi localPlayer = Networking.LocalPlayer;
			if (localPlayer == null)
			{
				return;
			}
			foreach (VRC_Pickup vrc_Pickup in PickupDropper.cachedPickups)
			{
				if (!(vrc_Pickup == null))
				{
					Networking.SetOwner(localPlayer, vrc_Pickup.gameObject);
					vrc_Pickup.Drop();
				}
			}
		}

		// Token: 0x04000117 RID: 279
		public static float dropDelay = 0.5f;

		// Token: 0x04000118 RID: 280
		public static bool C = false;

		// Token: 0x04000119 RID: 281
		public static List<VRC_Pickup> cachedPickups = OnLoadedScaneManager.allBaseUdonItem.ToList<VRC_Pickup>();
	}
}
